import glob, os, numpy

root_dir = "."
clause_list = [1458, 3677, 69529, 7121, 10361, 5921, 5921, 10681, 8881, 10361, 25061, 5921, 7401, 8901, 11901, 12461, 36129, 43251, 53018, 15777, 2518, 904, 474, 112462, 530713, 176313, 103556, 248504, 376, 16207, 12757, 3264, 70, 13236, 2058906, 1693500, 148086, 120068, 40169, 6978, 34241, 6923, 7143, 43573, 30963, 34881, 7297, 44327, 37893, 7176, 331028, 201968, 181073, 460862, 346850, 285404, 175697, 168347, 469046, 673711, 908191, 440151, 338946, 322159, 456921, 360419, 905106, 13913, 564196, 337439, 360099, 70332, 7491, 8745, 9721, 7334, 3517, 43251, 73478, 10940, 32450, 102047, 23144, 19908, 20423, 6756, 15110, 9526, 4909231, 3868693, 162922, 621323, 162934, 7008, 258294, 730905, 409139, 3865513, 1759150, 933803, 140056, 935928, 1221020, 162922, 750705, 750705, 933900, 5049, 505547, 819830, 1626156, 540984, 989885, 2905976, 787745, 935928, 548699, 540984, 29520, 331754, 231247, 3863287, 795900, 708801, 789283, 15983633, 270492, 454050, 7306, 7305, 7307, 7307, 7305, 7295, 7298, 7307, 7305, 3201, 7305, 7305, 3296, 7306, 7307, 7298, 3296, 7305, 3296, 109570, 89506, 158182, 1204273, 7864, 43408, 26561, 70492, 39571, 11182, 10471, 110920, 293050, 2804, 75712, 9579, 361795, 89473, 508465, 32962, 4772, 36979, 211126, 94713, 12812, 118192, 74554, 51803, 36942, 136878, 2006678, 3051359, 261401, 962496, 2529138, 2529021, 3330773, 3057947, 2529120, 1412178, 2003124, 1484506, 4700326, 942434, 1484738, 2006878, 1903361, 3051508, 2529090, 198942, 8853, 955, 13479, 20671, 8931, 7335, 1206, 13765, 2273, 9313, 10335, 159, 19571, 10926, 10988, 15627, 24048, 15332, 8586, 14164, 11662, 9609, 7452, 10997, 13822, 11806, 10800, 14978, 13022, 12102, 10650, 16701, 14572, 22420, 8541, 12929, 11431, 15759, 12452, 9642, 20018, 18665, 13497, 19428, 11909, 14766, 14026, 18319, 9658, 13938, 12285, 13331, 23922, 15065, 14156, 12693, 14193, 14803, 15154, 20890, 7648, 17322, 831950, 539763, 500869, 1170255, 605085, 605085, 652413, 937700, 1170345, 1172417, 1368643, 47620, 251823, 3788, 42956, 12053, 3371, 12437, 34454, 31997, 39035, 8738, 224868, 224473, 25116, 696581, 649270, 761906, 414657, 360419, 908255, 375699, 337439, 286428, 286158, 673711, 456921, 798348, 691064, 508210, 1696]

def number_of_clauses(ref_file):
    cnf_info = os.popen('grep "p cnf " {0}'.format(ref_file)).read()
    return int(cnf_info.split()[-1])

for root, dir_names, file_names in os.walk(root_dir):
    if len(file_names) > 0:
        for file in file_names:
            if file.strip().endswith(".bz2"):
                bz_file = root + "/" + file
                os.system('cp {0} .'.format(bz_file))
                os.system('bzip2 -d {0}'.format(file))

                cnf_file = os.path.splitext(file)[0]
                if number_of_clauses(cnf_file) <= 15000:
                    # the number of clauses threshold is 15000
                    os.system('cp {0} target'.format(cnf_file))

                os.remove(cnf_file)
